apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: sh-tools
spec:
  output:
    to:
      kind: ImageStreamTag
      name: sh-tools:latest
  source:
    dockerfile:
      FROM alpine@sha256:e2e16842c9b54d985bf1ef9242a313f36b856181f188de21313820e177002501

      RUN apk update && \
          apk del yq && \
          apk --no-cache add --update zip sed bash coreutils gettext

      ARG VERSION=v4.7.1
      ARG BINARY=yq_linux_amd64

      RUN wget  https://github.com/mikefarah/yq/releases/download/$VERSION/$BINARY -O /usr/bin/yq &&\
          chmod +x /usr/bin/yq
  strategy:
    type: Docker
    # dockerStrategy:
    #   buildArgs:
    #     - name: "network"
    #       value: "host"
  triggers:
    - type: ConfigChange
